# R2/R3/R4 导轨-滑杆-闭合回路：解析推进（无截断误差）与能量推导汇总

> 目标：把导轨滑杆在匀强磁场中运动（经典“导轨-滑杆-电阻回路”）整理成论文可用的推导与算法文档：
>
> - **解析推进**：像“旋转矩阵推进圆周运动”一样，每个时间步用解析解做**精确映射**（只剩浮点舍入误差，无数值积分截断误差）。
> - **能量关系**：汇总多条推导路线（微分方程解析解、动量定理、动能定理、功率平衡、热量积分、“瞬态额外热量”），并互相印证。
> - **可落地实现**：给出仿真所需的逐步算法（适合写进 Engine/Controller）。

---

## 0. 物理场景与符号约定

### 场景（R2/R3/R4）
- 两条平行导轨 + 可滑动导体杆（长度 **L**），与导轨构成闭合回路，回路等效电阻为 **R**。
- 匀强磁场 **B** 垂直于导轨平面（出/入纸面），杆沿导轨方向运动，速度标量为 **v(t)**。
- 设导轨方向为 **x 轴**，取 +x 为“驱动/运动正方向”。

> 方向判定（电流方向/电动势方向）在教学中可用 `v×B` + 正电荷受力方向说明。本文推导以标量形式为主：磁阻力写成 **-kv**（总是阻碍运动）。

### 符号
- 位置：\(x(t)\)
- 速度：\(v(t)=\frac{dx}{dt}\)
- 质量：\(m\)
- 磁场：\(B\)（大小；方向通过符号或 UI 叉/点表达）
- 杆长：\(L\)
- 电阻：\(R\)（等效总电阻）
- 驱动力：\(F_{drive}\)（沿 +x 为正，恒定或每步内视为常量）
- 摩擦：\(F_f\)（默认常值或每步常值；若为动摩擦 \(μN\cdot sgn(v)\)，需“过零事件分段”）

---

## 1. 电磁链路：\(ε\) → \(I\) → \(F_{mag}\)（阻尼）

### 1.1 动生电动势
\[
\varepsilon = BLv
\]

### 1.2 电流（闭合回路）
\[
I=\frac{\varepsilon}{R}=\frac{BL}{R}v
\]

### 1.3 磁阻力（安培力）
大小：
\[
|F_{\text{mag}}|=BIL
= B\left(\frac{BL}{R}v\right)L
=\frac{B^2L^2}{R}v
\]
定义阻尼系数：
\[
k \equiv \frac{B^2L^2}{R}
\]
由于阻碍运动（楞次定律），沿 +x 的标量力为：
\[
F_{\text{mag}}=-kv
\]

---

## 2. 动力学方程（R2/R3）

牛顿第二定律：
\[
m\frac{dv}{dt}=F_{\text{drive}}-kv-F_f
\]

令：
\[
\alpha=\frac{k}{m},\qquad b=\frac{F_{\text{drive}}-F_f}{m}
\]
化成一阶线性方程：
\[
\frac{dv}{dt}=b-\alpha v
\tag{1}
\]

---

## 3. 解析解与“无截断误差”的离散递推（核心）

### 3.1 速度解析解与终端速度
方程 (1) 的通解：
\[
v(t)=\frac{b}{\alpha}+\left(v_0-\frac{b}{\alpha}\right)e^{-\alpha t}
\]
定义终端速度：
\[
v_\infty=\frac{b}{\alpha}=\frac{F_{\text{drive}}-F_f}{k}
\]

### 3.2 速度的精确递推（一步解析映射）
以时间步长 Δt 离散，当前步起点为 v_n：
\[
\boxed{
v_{n+1}=v_\infty+(v_n-v_\infty)e^{-\alpha\Delta t}
}
\tag{2}
\]

> 与圆周运动类比：  
> - 圆周运动：\(v_{n+1}=R(\theta)v_n\)（正交映射，保速度模）  
> - 电磁阻尼：\(v_{n+1}=v_\infty+(v_n-v_\infty)e^{-\alpha\Delta t}\)（指数映射，趋近稳态）

### 3.3 位置的精确递推（对 v(t) 积分）
\[
x_{n+1}=x_n+\int_0^{\Delta t}v(t)\,dt
\]
代入解析 v(t) 并积分：
\[
\boxed{
x_{n+1}
= x_n + v_\infty\Delta t + \frac{v_n-v_\infty}{\alpha}(1-e{-\alpha\Delta t})
}
\tag{3}
\]

---

## 4. 退化情况：k=0（无磁场或开路）

当 k=0 → α=0：
\[
\frac{dv}{dt}=b
\Rightarrow
v_{n+1}=v_n+b\Delta t,\quad
x_{n+1}=x_n+v_n\Delta t+\frac12 b\Delta t^2
\]
也可由 (2)(3) 的 α→0 极限得到。

---

## 5. 每步派生物理量（R2/R4 输出）

通常取“步末值”（也可取步平均值）：
- 动生电动势：
  \[
  \varepsilon_{n+1}=BLv_{n+1}
  \]
- 电流：
  \[
  I_{n+1}=\varepsilon_{n+1}/R
  \]
- 磁阻力（大小）：
  \[
  |F_{\text{mag},n+1}|=kv_{n+1}
  \]
- 电功率（电阻发热）：
  \[
  P_{\text{elec}}=I^2R=kv^2
  \]
- 机械功率（外力功率）：
  \[
  P_{\text{mech}}=F_{\text{drive}}v
  \]

---

## 6. 能量关系：多条推导路线（互相印证）

### 6.1 功率平衡（瞬时形式）

由动力学方程

\[
m\frac{dv}{dt}=F_{\text{drive}}-kv-F_f
\]

两边乘 v：

\[
mv\frac{dv}{dt}=F_{\text{drive}}v-kv^2-F_f v
\]

而

\[
mv\frac{dv}{dt}=\frac{d}{dt}\left(\frac12 mv^2\right)
\]

所以得到瞬时功率平衡：

\[
\boxed{
F_{\text{drive}}v=kv^2 + F_f v + \frac{d}{dt}\left(\frac12 mv^2\right)
}
\tag{4}
\]
解释：

- 左侧：机械输入功率 \(P_{\text{mech}}\)
- 右侧：电阻耗散功率 \(kv^2=I^2R\) + 摩擦耗散功率 + 动能变化率

稳态（终端速度 \(\frac{dv}{dt}\)→0）时：
\[
P_{\text{mech}}\approx P_{\text{elec}}+P_{\text{fric}}
\]
这就是 R4 的功率验证。

---

### 6.2 动能定理（功-能关系）

动能定理：

\[
\Delta K=W_{\text{drive}}+W_{\text{mag}}+W_f
\]

磁阻力做负功并转化为热：

\[
Q_R=-W_{\text{mag}}=\int kv^2\,dt
\]

外力做功：

\[
W_{\text{drive}}=\int F_{\text{drive}}dx=F_{\text{drive}}\Delta x
\]

摩擦（常值）转热：

\[
Q_f=-W_f=\int F_f dx=F_f\Delta x
\]

得到能量守恒式（与 (4) 积分等价）：

\[
\boxed{
F_{\text{drive}}\Delta x=Q_R+Q_f+\Delta\left(\frac12 mv^2\right)
}
\tag{5}
\]

---

### 6.3 动量定理（冲量-动量）推导位移表达式

对
\[
m\frac{dv}{dt}=F_{\text{drive}}-kv-F_f
\]

从 \(0\) 到 \(t\) 积分：

\[
m(v_t-v_0)=(F_{\text{drive}}-F_f)t-k\int_0^t v\,dt
\]

而 \(\int_0^t v\,dt=x(t)-x(0)\)，取 x(0)=0：

\[
\boxed{
x(t)=\frac{(F_{\text{drive}}-F_f)t-m(v_t-v_0)}{k}
}
\tag{6}
\]

当 \(t\)→\(\infty\)，\(v_t\)→\(v_{\infty}\)，有：

\[
x(t)\sim v_\infty t-\frac{m}{k}(v_\infty-v_0)
\]

与解析解积分得到的位移形式一致。

---

### 6.4 电阻发热的解析积分（任意时长）

\[
P_{\text{elec}}=I^2R=kv^2,\quad
Q(t)=k\int_0^t v(s)^2 ds
\]

代入

\[
v(t)=v_\infty+(v_0-v_\infty)e^{-\alpha t}
\]

展开平方并积分得：

\[
\boxed{
\int_0^t v^2 ds = v_\infty^2 t
+\frac{2v_\infty(v_0-v_\infty)}{\alpha}(1-e^{-\alpha t})
+\frac{(v_0-v_\infty)^2}{2\alpha}(1-e^{-2\alpha t})
}
\tag{7}
\]

因此

\[
\boxed{
Q(t)=k\left[
v_\infty^2 t
+\frac{2v_\infty(v_0-v_\infty)}{\alpha}(1-e^{-\alpha t})
+\frac{(v_0-v_\infty)^2}{2\alpha}(1-e^{-2\alpha t})
\right]
}
\tag{8}
\]

---

### 6.5 “瞬态额外热量”（相对稳态基准）

总热量含随 t 线性增长的稳态项 \(kv_\infty^2 t\)。  
定义相对稳态的瞬态额外热量：

\[
Q_{\text{transient}}=\lim_{t\to\infty}\left[Q(t)-kv_\infty^2 t\right]=k\int_0^\infty (v^2-v_\infty^2)\,dt
\]

由 (8) 取极限（指数项→0）：

\[
Q_{\text{transient}}
=k\left[
\frac{2v_\infty(v_0-v_\infty)}{\alpha}
+\frac{(v_0-v_\infty)^2}{2\alpha}
\right]
\]

利用 \(\alpha = \frac{k}{m}\) 化简：

\[
\boxed{
Q_{\text{transient}}=
m(v_0-v_\infty)\left(\frac32 v_\infty+\frac12 v_0\right)
}
\tag{9}
\]

物理意义：
- \(v_0 = v_{\infty}\) → 0（无瞬态）
- \(v_0 > v_{\infty}\) → 初动能额外转热（正）
- \(v_0 <> v_{\infty}\) → 加速阶段部分功存入动能，相对稳态“少发热”（负）

---

### 6.6 热量、电荷量递推公式

我们利用能量守恒原理

#### 1) 先把“热量”拆成两类，否则一定会混

在单杆模型里至少有两种“热量”来源：

1. **电阻焦耳热（主要）**
   \[
   Q_R(t)=\int_0^t I^2R,dt = \int_0^t kv^2,dt,\quad k=\frac{B^2L^2}{R}
   \]

2. **摩擦热（如果你加了摩擦，但通常不考虑）**
   \[
   Q_f(t)=\int_0^t F_f,v,dt = F_f\Delta x \quad(\text{若 }F_f\text{为常值且方向固定})
   \]

外力做功 \(W_{\text{drive}}=\int F_{\text{drive}},dx\) 会被分配到：

* 动能变化 (\(\Delta K\))
* 电阻热 (\(Q_R\))
* 摩擦热 (\(Q_f\))

所以**最总的能量账**是：
\[
\boxed{W_{\text{drive}}=\Delta K+Q_R+Q_f}
\]

#### 2) 递推公式

我们希望减少运算、用“状态量递推”。在这个模型里，一个非常干净的状态集合是：

* 运动状态：(\(x_n, v_n\))
* 能量状态：(\(Q_{R,n}\))
* （可选）电荷状态：(\(q_n\))

递推结构统一写成：
\[
x_{n+1}=x_n+\Delta x_n,\quad
v_{n+1}=f(v_n),\quad
Q_{R,n+1}=Q_{R,n}+\Delta Q_{R,n},\quad
q_{n+1}=q_n+\Delta q_n
\]

其中最“省事”的增量表达是：

##### 电荷量增量（这条非常漂亮）

因为 \(I=\frac{BL}{R}v\)，所以
\[
\Delta q=\int I\,dt=\frac{BL}{R}\int v\,dt
=\boxed{\frac{BL}{R}\Delta x}
\]
也就是说：**只要你有 \(\Delta x\)，电荷量递推是线性的**。

##### 电阻热增量（推荐你用能量法）

\[
\boxed{\Delta Q_R=F_{\text{drive}}\Delta x-\frac12 m(v_{n+1}^2-v_n^2)}
\]

##### 平均功率（如果画功率曲线）

\[
\boxed{P_{\text{avg},n}=\frac{\Delta Q_{R,n}}{\Delta t}}
\]
（比用步末 \(kv_{n+1}^2\) 更“积分意义正确”）



#### 3) 我给你的最终结论（你可以直接写进文档/论文）

* **电阻热的递推公式完全可以做成和 (v,x) 同级的状态递推**：
  \[
  \boxed{
  Q_{R,n+1}=Q_{R,n}+F_{\text{drive}}(x_{n+1}-x_n)-\frac12 m(v_{n+1}^2-v_n^2)
  }
  \]
* **电荷量递推甚至更简单**：
  \[
  \boxed{
  q_{n+1}=q_n+\frac{BL}{R}(x_{n+1}-x_n)
  }
  \]
* **功率用平均值最干净**：
  \[
  \boxed{P_{\text{avg},n}=\frac{Q_{R,n+1}-Q_{R,n}}{\Delta t}}
  \]


## 7. 仿真算法（解析推进 + 解析能量核对）

对每个步长 \(\Delta\)（本步内参数常值）：

1. 计算
\[
k=\frac{B^2L^2}{R},\quad \alpha=\frac{k}{m},\quad v_\infty=\frac{F_{\text{drive}}-F_f}{k}
\]

2. 速度更新（解析）：
\[
v_{n+1}=v_\infty+(v_n-v_\infty)e^{-\alpha\Delta t}
\]

3. 位置更新（解析）：
\[
x_{n+1}=x_n + v_\infty\Delta t + \frac{v_n-v_\infty}{\alpha}(1-e^{-\alpha\Delta t})
\]
并记 \(\Delta x = x_{n+1} - x_{n}\)

4. 外力做功：
\[
W_{\text{drive},n}=F_{\text{drive}}\Delta x
\]

5. 电阻发热（一步内解析积分）：令 \(e=e^{-\alpha \Delta t}\)，\(A=v_{\infty}，B=v_n-v_{\infty}\)：
\[
\int_0^{\Delta t} v^2 dt
=
A^2\Delta t+\frac{2AB}{\alpha}(1-e)+\frac{B^2}{2\alpha}(1-e^{-2\alpha\Delta t})
\]
\[
E_{R,n}=k\int_0^{\Delta t} v^2 dt
\]

6. 动能变化：
\[
\Delta K_n=\frac12 m(v_{n+1}^2-v_n^2)
\]

7. 能量残差（理想≈0，仅浮点误差）：
\[
\text{res}_n=W_{\text{drive},n}-E_{R,n}-F_f\Delta x-\Delta K_n
\]

---

## 8. “完全解析”成立的条件（写论文要明确）

1) 每步内参数常量：B,L,R,m,F_drive,F_f 在 Δt 内不变  
2) 若 B 有界区域、R 变化、外力变化 → 必须做“事件分段”（场内/场外分段解析）  
3) 若摩擦为动摩擦 μN·sgn(v)，速度可能过零 → 必须做“过零事件分段”

---
